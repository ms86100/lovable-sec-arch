-- First, create stakeholders to have valid references for risks
INSERT INTO project_stakeholders (id, project_id, name, role, email, department, influence_level, raci_role, is_internal, contact_info, notes, created_by) VALUES 
-- CRM Mobile Optimization stakeholders
('77777777-7777-7777-7777-777777777001', '12345678-1234-1234-1234-123456789001', 'Robert Anderson', 'VP of Sales', 'robert.anderson@company.com', 'Sales', 'high', 'accountable', true, '{"phone": "+1-555-0101", "office": "Building A, Floor 5"}', 'Primary sponsor and decision maker for CRM enhancements', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),
('77777777-7777-7777-7777-777777777002', '12345678-1234-1234-1234-123456789001', 'Maria Garcia', 'Sales Operations Manager', 'maria.garcia@company.com', 'Sales Operations', 'high', 'consulted', true, '{"phone": "+1-555-0102", "office": "Building B, Floor 3"}', 'Provides operational requirements and user feedback', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- Banking Security Enhancement stakeholders
('77777777-7777-7777-7777-777777777003', '12345678-1234-1234-1234-123456789002', 'James Wilson', 'Chief Security Officer', 'james.wilson@company.com', 'Security', 'high', 'responsible', true, '{"phone": "+1-555-0103", "office": "Building A, Floor 2"}', 'Oversees all security initiatives and compliance', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),
('77777777-7777-7777-7777-777777777004', '12345678-1234-1234-1234-123456789002', 'Susan Chen', 'Compliance Officer', 'susan.chen@company.com', 'Legal & Compliance', 'high', 'consulted', true, '{"phone": "+1-555-0104", "office": "Building A, Floor 4"}', 'Ensures regulatory compliance and audit readiness', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- E-Learning Analytics stakeholders
('77777777-7777-7777-7777-777777777005', '12345678-1234-1234-1234-123456789003', 'Dr. Patricia Davis', 'VP of Education Technology', 'patricia.davis@company.com', 'Education', 'high', 'accountable', true, '{"phone": "+1-555-0105", "office": "Building C, Floor 2"}', 'Educational technology strategy and implementation', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- Healthcare Data Integration stakeholders
('77777777-7777-7777-7777-777777777006', '12345678-1234-1234-1234-123456789004', 'Dr. Michael Brown', 'Chief Medical Officer', 'michael.brown@company.com', 'Medical Affairs', 'high', 'accountable', true, '{"phone": "+1-555-0106", "office": "Building D, Floor 1"}', 'Clinical oversight and healthcare standards compliance', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),
('77777777-7777-7777-7777-777777777007', '12345678-1234-1234-1234-123456789004', 'Lisa Thompson', 'Healthcare IT Director', 'lisa.thompson@company.com', 'Healthcare IT', 'high', 'responsible', true, '{"phone": "+1-555-0107", "office": "Building E, Floor 3"}', 'Technical implementation and system integration', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'));

-- Now create project risks with corrected references to user IDs from profiles table
INSERT INTO project_risks (id, project_id, title, description, category, probability, impact, severity_level, status, mitigation_strategy, assigned_to, risk_owner, due_date, resolution_date, created_by) VALUES 
-- CRM Mobile Optimization risks - using team member IDs for assigned_to but user_id for risk_owner
('66666666-6666-6666-6666-666666666001', '12345678-1234-1234-1234-123456789001', 'Cross-Platform Compatibility', 'Potential issues with app performance across different mobile platforms', 'technical', 'medium', 'medium', 'medium', 'open', 'Extensive testing on all target platforms and devices', '22222222-2222-2222-2222-222222222002', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'), '2024-07-31', NULL, COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),
('66666666-6666-6666-6666-666666666002', '12345678-1234-1234-1234-123456789001', 'Data Synchronization Complexity', 'Risk of data conflicts during offline/online synchronization', 'technical', 'high', 'high', 'high', 'mitigated', 'Implement robust conflict resolution algorithms and user feedback mechanisms', '22222222-2222-2222-2222-222222222003', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'), '2024-06-15', '2024-05-20', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- Banking Security Enhancement risks
('66666666-6666-6666-6666-666666666003', '12345678-1234-1234-1234-123456789002', 'Regulatory Changes', 'Potential changes in financial regulations affecting security requirements', 'compliance', 'medium', 'high', 'high', 'open', 'Regular monitoring of regulatory updates and flexible architecture design', '22222222-2222-2222-2222-222222222005', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'), '2024-07-15', NULL, COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),
('66666666-6666-6666-6666-666666666004', '12345678-1234-1234-1234-123456789002', 'False Positive Rates', 'High false positive rates in fraud detection could impact user experience', 'operational', 'high', 'medium', 'medium', 'open', 'Continuous model tuning and user feedback integration', '22222222-2222-2222-2222-222222222005', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'), '2024-06-30', NULL, COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- E-Learning Analytics risks (resolved)
('66666666-6666-6666-6666-666666666005', '12345678-1234-1234-1234-123456789003', 'Privacy Compliance', 'Student data privacy concerns and FERPA compliance requirements', 'compliance', 'medium', 'high', 'high', 'resolved', 'Implemented comprehensive data anonymization and access controls', '22222222-2222-2222-2222-222222222008', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'), '2024-01-15', '2024-01-10', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- Healthcare Data Integration risks
('66666666-6666-6666-6666-666666666006', '12345678-1234-1234-1234-123456789004', 'HIPAA Compliance', 'Ensuring all healthcare data integration meets HIPAA requirements', 'compliance', 'high', 'critical', 'critical', 'open', 'Engage healthcare compliance experts and implement robust security measures', '22222222-2222-2222-2222-222222222010', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'), '2024-08-31', NULL, COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'));

-- Create project status updates
INSERT INTO project_status_updates (id, project_id, summary, achievements, challenges, next_steps, progress_percentage, milestone_reached, budget_spent, update_date, updated_by) VALUES 
-- CRM Mobile Optimization updates
('88888888-8888-8888-8888-888888888001', '12345678-1234-1234-1234-123456789001', 'Mobile API optimization completed successfully', 'API response times improved by 60%. Offline sync architecture designed and partially implemented.', 'Cross-platform testing revealing some performance inconsistencies on older Android devices.', 'Complete offline sync implementation and begin React Native app development.', 65, 'Backend API Development', 185000.00, '2024-06-01', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- Banking Security Enhancement updates  
('88888888-8888-8888-8888-888888888002', '12345678-1234-1234-1234-123456789002', 'Fraud detection system showing excellent results', 'ML models achieving 99.2% accuracy with only 0.3% false positive rate. Real-time monitoring dashboard operational.', 'SOC 2 audit preparation taking longer than expected due to documentation requirements.', 'Finalize compliance documentation and begin final security testing phase.', 80, 'Fraud Detection System', 197000.00, '2024-06-15', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- E-Learning Analytics updates (final)
('88888888-8888-8888-8888-888888888003', '12345678-1234-1234-1234-123456789003', 'Analytics platform successfully deployed', 'All learning analytics features implemented and deployed. Predictive models showing 87% accuracy in performance prediction.', 'Initial user adoption slower than expected, requiring additional training materials.', 'Project complete. Transition to maintenance mode with quarterly feature updates.', 100, 'Predictive Analytics', 125000.00, '2024-02-28', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111')),

-- Healthcare Data Integration updates
('88888888-8888-8888-8888-888888888004', '12345678-1234-1234-1234-123456789004', 'Project planning and initial assessment underway', 'Healthcare standards assessment completed. Initial team assembled and requirements gathering started.', 'Complexity of HIPAA compliance requirements higher than initially estimated.', 'Complete detailed technical architecture design and begin pilot integration testing.', 15, 'Standards Assessment', 18000.00, '2024-07-15', COALESCE((SELECT user_id FROM profiles LIMIT 1), '11111111-1111-1111-1111-111111111111'));